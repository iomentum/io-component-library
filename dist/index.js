"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),n=require("react-dropzone"),t=require("styled-components");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=r(e),a=r(t),i=function(){return(i=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var o in n=arguments[t])Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o]);return e}).apply(this,arguments)};function l(e,n){var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&n.indexOf(r)<0&&(t[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(e);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(e,r[o])&&(t[r[o]]=e[r[o]])}return t}function c(e,n,t,r){return new(t||(t=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function l(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var n;e.done?o(e.value):(n=e.value,n instanceof t?n:new t((function(e){e(n)}))).then(i,l)}c((r=r.apply(e,n||[])).next())}))}function u(e,n){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:l(0),throw:l(1),return:l(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=n.call(e,i)}catch(e){a=[6,e],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}}function s(e,n){return Object.defineProperty?Object.defineProperty(e,"raw",{value:n}):e.raw=n,e}var d,f=a.default.div(d||(d=s(["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n  border-width: 2px;\n  border-radius: 2px;\n  border-color: ",";\n  border-style: dashed;\n  background-color: #fafafa;\n  color: #bdbdbd;\n  outline: none;\n  transition: border 0.24s ease-in-out;\n"],["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n  border-width: 2px;\n  border-radius: 2px;\n  border-color: ",";\n  border-style: dashed;\n  background-color: #fafafa;\n  color: #bdbdbd;\n  outline: none;\n  transition: border 0.24s ease-in-out;\n"])),(function(e){return function(e){return e.isDragAccept?"#00e676":e.isDragReject?"#ff1744":e.isDragActive?"#2196f3":"#eeeeee"}(e)})),p=require("blitz-resize");var m=function(e,n){var t=function(e){switch(e.name.substring(e.name.lastIndexOf(".")+1)){case"png":return.8;default:return 1}}(e);return n/e.size*t},v=p.create();function b(e,n){return c(this,void 0,void 0,(function(){var t,r=this;return u(this,(function(o){switch(o.label){case 0:return[4,(a=e,new Promise((function(e,n){var t=new FileReader;t.onload=function(t){var r,o=null===(r=null==t?void 0:t.target)||void 0===r?void 0:r.result;return"string"!=typeof o?n(new Error("couldn't read file contents")):e(o)},t.onerror=function(e){return n(e)},t.readAsDataURL(a)})))];case 1:return t=o.sent(),[2,new Promise((function(o,a){var i=new Image;i.onload=function(){return c(r,void 0,void 0,(function(){var t;return u(this,(function(r){switch(r.label){case 0:return[4,v({source:e,width:Math.floor(n*i.width)})];case 1:return t=r.sent(),o(new File([t],e.name,{type:t.type})),[2]}}))}))},i.onerror=function(){a(Error("couldn't load image into canvas for resize "+e.name))},i.src=t}))]}var a}))}))}var y,h,g,x,w,E=function(t){var r=t.setImagesToUpload,a=t.setUploadError,s=t.maxUploadSize,d=void 0===s?1e6:s,p=t.label,v=void 0===p?"Glissez-dÃ©posez votre image ici, ou cliquez pour rechercher un fichier":p,y=l(t,["setImagesToUpload","setUploadError","maxUploadSize","label"]),h=n.useDropzone({accept:"image/*"}),g=h.getRootProps,x=h.getInputProps,w=h.isDragActive,E=h.isDragAccept,O=h.isDragReject,j=h.acceptedFiles;return e.useEffect((function(){j.length>0&&Promise.all(j.map((function(e){return function(e,n){return c(this,void 0,void 0,(function(){var t;return u(this,(function(r){return n>=e.size?[2,e]:(t=m(e,n),[2,b(e,t)])}))}))}(e,d)}))).then((function(e){r(e)})).catch((function(e){a(e)}))}),[j,r,a]),o.default.createElement(f,i({},g({isDragActive:w,isDragAccept:E,isDragReject:O}),y),o.default.createElement("input",i({},x())),o.default.createElement("p",null,v))},O=a.default.div(y||(y=s(["\n  display: flex;\n  flex-direction: row;\n  margin: 20px 0;\n\n  justify-content: center;\n  flex-wrap: wrap;\n"],["\n  display: flex;\n  flex-direction: row;\n  margin: 20px 0;\n\n  justify-content: center;\n  flex-wrap: wrap;\n"]))),j=a.default.div(h||(h=s(["\n  position: relative;\n  height: 140px;\n  cursor: pointer;\n  padding: 10px;\n  &:hover .middle {\n    opacity: 1;\n  }\n  &:hover .image {\n    opacity: 0.3;\n  }\n"],["\n  position: relative;\n  height: 140px;\n  cursor: pointer;\n  padding: 10px;\n  &:hover .middle {\n    opacity: 1;\n  }\n  &:hover .image {\n    opacity: 0.3;\n  }\n"]))),D=a.default.img(g||(g=s(["\n  opacity: 1;\n  display: block;\n  height: 100%;\n  width: auto;\n  transition: 0.5s ease;\n  backface-visibility: hidden;\n"],["\n  opacity: 1;\n  display: block;\n  height: 100%;\n  width: auto;\n  transition: 0.5s ease;\n  backface-visibility: hidden;\n"]))),P=a.default.div(x||(x=s(["\n  transition: 0.5s ease;\n  opacity: 0;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  -ms-transform: translate(-50%, -50%);\n  text-align: center;\n"],["\n  transition: 0.5s ease;\n  opacity: 0;\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n  -ms-transform: translate(-50%, -50%);\n  text-align: center;\n"]))),U=require("./copy-icon.png"),k=function(e){var n=e.fileList;l(e,["fileList"]);return o.default.createElement(O,null,n.map((function(e,n){return o.default.createElement(j,{key:n,onClick:function(){return function(e){navigator.clipboard.writeText(e.url)}(e)}},o.default.createElement(D,{src:e.url,alt:"Image",className:"image"}),o.default.createElement(P,{className:"middle"},o.default.createElement(D,{src:U,alt:"copy-icon",className:"copy-icon"})))})),o.default.createElement("div",null))},z=a.default.div(w||(w=s(["\n  color: ##ed4337;\n"],["\n  color: ##ed4337;\n"])));exports.ThumbnailsMosaic=k,exports.UploadSection=function(n){var t=n.setImagesReadyForUpload,r=n.filesToDisplay,a=l(n,["setImagesReadyForUpload","filesToDisplay"]),c=e.useState(null)[1];return o.default.createElement("div",i({},a),o.default.createElement(E,{setImagesToUpload:t,setUploadError:c}),o.default.createElement(z,null,o.default.createElement("h4",null,"Un erreur est survenue lors de l'envoi d'images:"),o.default.createElement("p",null," ","Le fichier n'est pas bon"," ")),o.default.createElement(k,{fileList:r}))};
